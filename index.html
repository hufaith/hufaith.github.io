<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-HBase学习笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/07/HBase%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2021-01-07T14:43:47.675Z" itemprop="datePublished">2021-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="HBase学习笔记"><a href="#HBase学习笔记" class="headerlink" title="HBase学习笔记"></a>HBase学习笔记</h1><h2 id="一、HBase安装"><a href="#一、HBase安装" class="headerlink" title="一、HBase安装"></a>一、HBase安装</h2><p>###服务器端HBase开启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;start-hbase.sh</span><br><span class="line">.&#x2F;hbase-daemon.sh start thrift</span><br></pre></td></tr></table></figure>
<p>###客户端Python相关包安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install hbase-python -i http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F; --trusted-host pypi.douban.com</span><br><span class="line">pip install thrift -i http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F; --trusted-host pypi.douban.com</span><br><span class="line">pip install hbase-thrift -i http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F; --trusted-host pypi.douban.com</span><br></pre></td></tr></table></figure>
<p>###HBase安装包文件替换</p>
<p>由于对HBase操作目前只支持python2，如果使用python3会报一些错误。需要替换该目录下的文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\Anaconda3\Lib\site-packages\hbase\Hbase.py</span><br><span class="line">D:\Anaconda3\Lib\site-packages\hbase\ttypes.py</span><br></pre></td></tr></table></figure>
<h2 id="二、入门"><a href="#二、入门" class="headerlink" title="二、入门"></a>二、入门</h2><h3 id="1、HBase介绍"><a href="#1、HBase介绍" class="headerlink" title="1、HBase介绍"></a>1、HBase介绍</h3><p>HBase 是一种专门为半结构化数据和水平可扩展性设计的数据库。它把数据存储在表里。在表里，数据按照一个四维坐标系统来组织：行键、列族、列限定符和时间版本。HBase 表的行有唯一标识符， 叫做行键( rowkey )。HBase 是无模式数据库，只需要提前定义列族。它也是无类型数据库，把所有数据不加解释地按照字节数组存储。基于非行键值查询HBase 的唯一办法是通过带过滤器的扫描。HBase 不是一个ACID 兼容数据库（原子性、一致性、隔离性、持久性）。</p>
<p>六个概念：表、行、列族（必须事前定义并且不轻易修改，表中每行拥有相同的列族）、</p>
<p>​            列（不必事前定义，不必在不同行保持一致）、单元、时间版本</p>
<p>五个基本命令：Get (读)、Put (写)、Delete ( 删除)、Scan (扫描)和Increment (递增)。</p>
<h3 id="2、工作机制：HBase写路径"><a href="#2、工作机制：HBase写路径" class="headerlink" title="2、工作机制：HBase写路径"></a>2、工作机制：HBase写路径</h3><p>默认情况下，执行写入时会写到两个地方：预写式日志（WAL）和内存写入缓存区（MemStore）。只有当这两个地方的变化信息都写入并确认后，才认为写动作完成。写操作会写入预写式WAL和MemStore。客户端在写的过程中不会与底层的HFile直接交互。每次写入HBase 需要来自WAL 和MemStore 的确认。这两个确认确保每次写入HBase 在尽可能快的同时保证持久性。当MemStore写满时，会刷写到硬盘，生成一个新HFile。HFile是HBase使用的底层存储格式。在集群的每个节点上，每个列族有一个MemStore。</p>
<p>在应对硬件故障导致数据丢失时，HBase解决方法是在写动作完成之前先写入WAL。WAL是底层文件系统上的一个文件（一般是HDFS）。直到WAL新纪录成功写入后，写动作才被认为成功完成。如果HBase服务器宕机，没有从MemStore里刷写到HFile的数据可以通过回放WAL来恢复，不需要手工执行，HBase的内部机制中有恢复流程部分来处理。每台HBase服务器有一个WAL，这台服务器上的所有表和列族共享这个WAL。</p>
<h3 id="3、工作机制：HBase读路径"><a href="#3、工作机制：HBase读路径" class="headerlink" title="3、工作机制：HBase读路径"></a>3、工作机制：HBase读路径</h3><p>HBase实现快速访问的技术：LRU缓存技术（最近最少使用算法），即BlockCache，用来保存从HFile里读入内存的频繁访问的数据，每个列族都有自己的BlockCache。</p>
<p>Block 是HBase从硬盘完成一次读取的数据单位。HFile 物理存放形式是一个Block 的序列外加这些Block的索引。这意味着，从HBase 里读取一个Block需要先在索引上查找一次该Block然后从硬盘读出。Block 是建立索引的最小数据单位，也是从硬盘读取的最小数据单位。Block大小按照列族设定，默认值是64KB。根据使用场景调大或者调小该值。如果主要用于随机查询，你可能需要细粒度的Block 索引，小一点儿的Block更好一些。Block变小会导致索引变大，进而消耗更多内存。如果你经常执行顺序扫描，一次读取多个Block，大一点儿的Block 更好一些。Block变大意味着索引项变少，索引变小，因此节省内存。</p>
<p>从HBase 中读出一行，首先会检查MemStore 等待修改的队列，然后检查BlockCache看包含该行的Block是否最近被访问过最后访问硬盘上的对应HFile。</p>
<h3 id="4、合并：HBase的后台工作"><a href="#4、合并：HBase的后台工作" class="headerlink" title="4、合并：HBase的后台工作"></a>4、合并：HBase的后台工作</h3><p>Delete并不立即删除内容，只是给记录打上删除的标记，使其不能再Get和Scan命令中返回结果。直到执行一次大合并，这些记录才会被彻底删除。</p>
<p>合并分为大合并和小合并。小合并从已有的多个小HFile里读出记录，合并成一个大HFile，然后新Hfile标记为激活状态，删除老HFile。HBase根据文件的号码和大小决定合并哪些文件。小合并设计出发点是轻微影响HBase 的性能。</p>
<p>大合并同时处理一个列族的全部HFile，大合并完成后，这个列族的所有HFile合并成一个文件。大合并是清理被删除记录的唯一机会。</p>
<h3 id="5、有时间版本的数据"><a href="#5、有时间版本的数据" class="headerlink" title="5、有时间版本的数据"></a>5、有时间版本的数据</h3><p>每次在单元上执行操作，HBase都隐式的存储一个新时间版本。Get请求根据提供的参数调出相应的版本。当没有设定时间版本时，HBase以毫秒为单位使用当前时间，所以版本数字用长整型long表示。HBase默认存储3个版本，可以基于列族设置。如果一个单元的版本超过了最大数量，多出的记录在下一次大合并时会扔掉。</p>
<h2 id="三、分布式的HBase、HDFS、MapReduce"><a href="#三、分布式的HBase、HDFS、MapReduce" class="headerlink" title="三、分布式的HBase、HDFS、MapReduce"></a>三、分布式的HBase、HDFS、MapReduce</h2><h3 id="1、MapReduce"><a href="#1、MapReduce" class="headerlink" title="1、MapReduce"></a>1、MapReduce</h3><p>###2、分布式模式HBase</p>
<h3 id="3、HDFS"><a href="#3、HDFS" class="headerlink" title="3、HDFS"></a>3、HDFS</h3><p>##十、遇到的坑</p>
<p>1、最好与上一层不要有相同的变量</p>
<p>2、对于python一些习惯例如：</p>
<p><code>for i in data.split(&#39;,&#39;)</code></p>
<p>不要用，写为两行</p>
<p>3、HBase经常有问题会爆发式输出库内所有数据，注意列族内列标识的名称</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/07/HBase%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="ckjmyp34c00006gc127nk5ygo" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/07/hello-world/" class="article-date">
  <time class="dt-published" datetime="2021-01-07T14:27:27.346Z" itemprop="datePublished">2021-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/07/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/07/hello-world/" data-id="ckjmy6cb20000ecc13f0t9yle" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/07/HBase%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/01/07/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>